// SPDX-License-Identifier: CC BY-NC-SA 4.0

///
/// Chapter Grid Component
///
/// Grid-Layout für Comic-Thumbnails (Archive, Suche, etc.).
///

/*!
 * @file      resources/scss/components/_chapter-grid.scss
 * @link      ftk.jus-or.de
 *
 * @copyright (c) 2025 Felix Maywald. CC BY-NC-SA 4.0
 * @license   https://github.com/RaptorXilef/twokinds.4lima.de/blob/main/LICENSE
 *
 * @author    Felix Maywald (@RaptorXilef)
 * @link      https://github.com/RaptorXilef/twokinds.4lima.de
 */

///
/// @since    5.0.0
/// - refactor(SCSS): Aus pages/_archive.scss extrahiert.
/// - feat(Design): Modernes CSS Grid (Responsive) statt altem Flexbox-Layout implementiert (wie bei Charaktere).
///

@use '../abstracts/variables' as *;
@use '../abstracts/mixins' as *;

.chapter-links {
    // Modern CSS Grid statt Flexbox
    display: grid;
    // Responsive Spalten: Mindestens 96px breit, füllen den Platz aus
    grid-template-columns: repeat(auto-fill, minmax(96px, 1fr));
    gap: 10px;
    margin-top: 10px;
    justify-content: center;

    noscript {
        display: contents; // Damit Grid auch bei Noscript greift, falls Wrapper stören
    }

    // 1. Link Item Styling
    a {
        position: relative;
        display: block;
        // width/height nicht mehr fix, sondern durch Grid gesteuert
        aspect-ratio: 1 / 1.3; // Hochformat für Comic-Seiten (anpassbar, z.B. 1/1 für Quadrat)
        background-color: var(--button-bg);
        text-decoration: none;
        color: var(--text-on-medium);
        font-size: 1.2em;
        overflow: hidden;
        border-radius: 5px; // Abrundung wie bei Characters
        transition: transform 0.2s ease-in-out;

        // Hover Effect: Scale Up
        &:hover {
            box-shadow: 0 4px 8px rgb(0 0 0 / 30%);
            transform: scale(1.05);
            z-index: 10;
        }

        @include media-retina-mobile {
            // Mobile Anpassungen falls nötig
        }

        // Overlay Span (Nummer/Text)
        span {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            position: absolute;
            bottom: 0; // Text unten statt mittig überdeckend
            left: 0;
            background: rgb(0 0 0 / 65%); // Halbtransparent Schwarz
            color: #fff;
            padding: 5px 0;
            font-size: 14px;
            z-index: 80;
            transition: background-color 0.2s;
        }

        // Delete Button (Admin)
        .delete {
            position: absolute;
            z-index: 91;
            top: 4px;
            right: 2px;
            background: rgb(255 255 255 / 20%);
            border-radius: 50%;
            padding: 2px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;

            svg {
                width: 18px;
                height: 18px;
                color: #f00;
                stroke: #fff;
                stroke-width: 2px;
                filter: drop-shadow(0 0 1px rgb(0 0 0 / 50%));
            }

            &:hover svg {
                color: #c00;
            }
        }
    }

    // 2. Image Logic
    img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover; // Füllt die Box aus, beschneidet ggf. Ränder
        border-radius: 3px;
        transition: opacity 0.5s;
    }

    // Lazy Loading Logic
    img:not(.delicon) {
        opacity: 0;
    }

    // Wenn geladen oder Noscript -> Sichtbar
    a noscript img,
    a.loaded img {
        opacity: 1;
    }

    // 3. Theme Overrides
    body.theme-night & {
        a {
            color: var(--text-color);
            background-color: var(
                --content-area-bg
            ); // Dunklerer Hintergrund für Platzhalter
        }

        a span {
            background-color: rgb(0 0 0 / 80%);
        }
    }
}
