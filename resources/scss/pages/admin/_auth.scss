// SPDX-License-Identifier: CC BY-NC-SA 4.0

///
/// Admin Authentifizierung & Benutzerverwaltung.
///
/// Styling für Login, User-Liste und Passwort-Management.
/// Styles für Login, Benutzermanagement und Passwortänderung.
///

/*!
 * @file       resources/scss/pages/admin/_auth.scss
 */
/// @link      twokinds.4lima.de
///
/// @copyright (c) 2025 Felix Maywald. CC BY-NC-SA 4.0
/// @license   https://github.com/RaptorXilef/twokinds.4lima.de/blob/main/LICENSE
///
/// @author    Felix Maywald (@RaptorXilef)
/// @link      https://github.com/RaptorXilef/twokinds.4lima.de
///

///
/// @since    5.0.0
/// - Aus _admin.scss extrahiert (Phase 1 Refactoring).
/// - style(Refactor): Nesting reduziert (Phase 2 Flattening).
/// - style(SCSS): .user-list und .admin-form optimiert.
///

// Verwendete SCSS-Variablen:
// (Keine spezifischen SCSS-Vars in diesem Block)

// Verwendete CSS-Variablen (Custom Properties):
// - --content-bg: Hintergrund für Container
// - --sidebar-bg: Hintergrund im Dark Mode
// - --border-medium: Mittlere Rahmenfarbe
// - --border-light: Helle Rahmenfarbe
// - --text-color: Standard Textfarbe
// - --content-area-bg: Hintergrund für Inputs
// - --link-color: Akzentfarbe / Button Hintergrund
// - --link-color-rgb: RGB-Werte der Akzentfarbe für Schatten
// - --table-row-even: Hintergrund für Listenelemente
// - --table-row-hover: Hintergrund bei Hover
// - --text-color-light: Helle Textfarbe (Icons/Tags)
// - --table-header-bg: Hintergrund für Tags

@use '../../abstracts/variables' as *;

/* --- Admin Login --- */
.admin-login-container {
    max-width: 450px;
    padding: 30px;
    margin: 60px auto;
    background-color: var(--content-bg);
    border: 1px solid var(--border-medium);
    border-radius: 8px;
    box-shadow: 0 5px 15px rgb(0 0 0 / 0.05);
}

body.theme-night .admin-login-container {
    background-color: var(--sidebar-bg);
    border-color: var(--border-light);
    box-shadow: 0 5px 15px rgb(0 0 0 / 0.3);
}

.admin-login-container h2 {
    padding-bottom: 15px;
    margin-bottom: 25px;
    font-size: 1.5em;
    color: var(--text-color);
    text-align: center;
    border-bottom: 1px solid var(--border-light);
}

.admin-login-container .intro-text {
    margin-bottom: 20px;
    color: var(--text-color);
    text-align: center;
}

.admin-login-container .status-message {
    margin-bottom: 20px;
    text-align: center;
}

// Spezielle Breite für Setup-Seiten (Wiederverwendung der Login-Basis)
.admin-login-container.setup-page {
    max-width: 800px;
}

/* --- Shared Form Styles (Flat) --- */
// .admin-form Siehe components/admin/_form.scss

/* --- User Management & Credentials Shared Styles --- */
.user-management-container,
.login-management-container {
    max-width: 800px;
    padding: 30px;
    margin: 40px auto;
    background-color: var(--content-bg);
    border: 1px solid var(--border-medium);
    border-radius: 8px;
    box-shadow: 0 5px 15px rgb(0 0 0 / 0.05);
}

body.theme-night .user-management-container,
body.theme-night .login-management-container {
    background-color: var(--sidebar-bg);
    border-color: var(--border-light);
    box-shadow: 0 5px 15px rgb(0 0 0 / 0.3);
}

.user-management-container h2,
.login-management-container h2 {
    padding-bottom: 15px;
    margin-top: 0;
    margin-bottom: 25px;
    font-size: 1.5em;
    color: var(--text-color);
    text-align: center;
    border-bottom: 1px solid var(--border-light);
}

.section-divider {
    padding-top: 25px;
    margin-top: 30px;
    border-top: 1px dashed var(--border-medium);
}

.section-divider:first-of-type {
    padding-top: 0;
    margin-top: 0;
    border-top: none;
}

// Spezifisch für Login-Management (kein Padding oben)
.login-management-container .section-divider {
    padding-top: 0;
    margin-top: 0;
    border: none;
}

.section-divider h3 {
    padding-left: 10px;
    margin-bottom: 20px;
    font-size: 1.2em;
    color: var(--text-color);
    border-left: 4px solid var(--link-color);
}

.password-wrapper {
    position: relative;
    display: flex;
    align-items: stretch;
    width: 100%;

    input {
        width: 100%;
        // Wir reservieren standardmäßig Platz für ein Icon (40px)
        // Im Falle eines Managers wird das Padding per JS auf 75px erhöht
        padding-right: 40px;
        transition: padding-right 0.3s ease;
    }

    .password-toggle {
        position: absolute;
        // Standard: Sauber am rechten Rand (10px)
        right: 10px;
        top: 50%;
        transform: translateY(-50%);

        width: 28px;
        height: 28px;
        padding: 0;
        margin: 0;
        background: transparent !important;
        border: none !important;
        color: var(--text-color-medium);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0.6;
        z-index: 20; // Höher als die meisten PM-Icons
        transition:
            right 0.3s cubic-bezier(0.4, 0, 0.2, 1),
            opacity 0.2s;

        &:hover {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
        }

        i {
            font-size: 16px;
            pointer-events: none;
        }
    }

    // Wenn KeePassXC oder ein anderer Manager erkannt wurde:
    &.pm-detected {
        input {
            padding-right: 75px; // Platz für beide Icons schaffen
        }
        .password-toggle {
            right: 42px; // Auge nach links schieben (hinter den Schlüssel)
        }
    }
}

/**
 * SPIESSER-TIPP: Browser-eigene Icons deaktivieren
 * Verhindert, dass Chrome/Edge ihr eigenes "Auge" über deins legen.
 */
input::-ms-reveal,
input::-ms-clear,
input::-webkit-password-toggle,
input::-webkit-credentials-auto-fill-button {
    display: none !important;
}

/* --- Specific Form Tweaks --- */
// User Management Form
.user-management-container .admin-form {
    margin-bottom: 20px;
}

.user-management-container .admin-form .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.user-management-container .admin-form button {
    align-self: flex-start;
    width: auto; // Reset width: 100%
    padding: 10px 20px;
    font-size: 1em;
}

// Login Management Form
.login-management-container .admin-form {
    gap: 15px;
}

.login-management-container .admin-form div {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.login-management-container .form-hr {
    margin: 25px 0;
    border: 0;
    border-top: 1px dashed var(--border-medium);
}

/* --- User List --- */
.user-list {
    padding: 0;
    margin: 0;
    list-style: none;
}

.user-list li {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 15px;
    margin-bottom: 10px;
    background-color: var(--table-row-even);
    border: 1px solid var(--border-medium);
    border-radius: 4px;
    transition:
        background-color 0.2s,
        border-color 0.2s;
}

body.theme-night .user-list li {
    background-color: rgb(0 0 0 / 0.2);
}

.user-list li:hover {
    background-color: var(--table-row-hover);
    border-color: var(--link-color);
}

.user-list .user-name {
    display: flex;
    gap: 10px;
    align-items: center;
    font-weight: bold;
    color: var(--text-color);
}

.user-list .user-name::before {
    font-family: $font-icon;
    font-weight: 900;
    color: var(--text-color-light);
    content: '\f007'; // FontAwesome User Icon
}

.user-list .current-user-tag {
    padding: 2px 8px;
    font-size: 0.9em;
    font-style: italic;
    color: var(--text-color-light);
    background-color: var(--table-header-bg);
    border-radius: 10px;
}

.user-list form {
    margin: 0;
}
