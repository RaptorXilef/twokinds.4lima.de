// SPDX-License-Identifier: CC BY-NC-SA 4.0

///
/// Thumbnail Grid Component
///
/// Universelles Grid-Layout für Comics, Charaktere und Lesezeichen.
/// Ersetzt spezifische Grids in Archive und Characters.
///

/*!
 * @file      resources/scss/components/_thumbnail-grid.scss
 * @link      twokinds.4lima.de
 *
 * @copyright (c) 2025 Felix Maywald. CC BY-NC-SA 4.0
 * @license   https://github.com/RaptorXilef/twokinds.4lima.de/blob/main/LICENSE
 *
 * @author    Felix Maywald (@RaptorXilef)
 * @link      https://github.com/RaptorXilef/twokinds.4lima.de
 */

///
/// @since    5.0.0-alpha.3
/// - refactor(SCSS): Zusammenführung von .chapter-links und .tag-page-links in eine wiederverwendbare Komponente.
/// - feat(Design): Modernes CSS Grid für alle Galerien.
///

@use '../abstracts/variables' as *;
@use '../abstracts/mixins' as *;

// Gemeinsame Selektoren für alle Grids
.chapter-links,
.tag-page-links,
.thumbnail-grid {
    display: grid;
    // Responsive: Min 96px, Max Space-filling
    grid-template-columns: repeat(auto-fill, minmax(96px, 1fr));
    gap: 10px;
    margin-top: 10px;
    justify-content: center;

    noscript {
        display: contents;
    }

    // 1. Item Card Styling
    a {
        position: relative;
        display: block;
        aspect-ratio: 1 / 1.3; // Standard Hochformat (Comic)
        background-color: var(--button-bg); // Fallback / Loading BG
        text-decoration: none;
        color: var(--text-on-medium);
        font-size: 1.2em;
        overflow: hidden;
        border-radius: 5px;
        transition: transform 0.2s ease-in-out;

        // Hover Effect
        &:hover {
            box-shadow: 0 4px 8px rgb(0 0 0 / 30%);
            transform: scale(1.05);
            z-index: 10;
            background-color: var(--button-hover-bg);
        }

        @include media-retina-mobile {
            zoom: 1.5; // Ggf. anpassen oder entfernen für reines CSS Grid
        }

        // Overlay (Text/Nummer)
        span {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            position: absolute;
            bottom: 0;
            left: 0;
            background: rgb(0 0 0 / 65%);
            color: #fff;
            padding: 5px 0;
            font-size: 14px;
            z-index: 80;
            transition: background-color 0.2s;
        }

        // Delete Button (Admin/Bookmarks)
        .delete {
            position: absolute;
            z-index: 91;
            top: 4px;
            right: 2px;
            background: rgb(255 255 255 / 20%);
            border-radius: 50%;
            padding: 2px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            opacity: 0; // Standardmäßig unsichtbar bis Hover (Desktop)
            transition:
                opacity 0.2s,
                background-color 0.2s;

            @include media-retina-mobile {
                opacity: 1; // Auf Mobile immer sichtbar
                top: 3px;
            }

            svg {
                width: 18px;
                height: 18px;
                color: #f00;
                stroke: #fff;
                stroke-width: 2px;
                filter: drop-shadow(0 0 1px rgb(0 0 0 / 50%));
            }

            &:hover {
                background: rgb(255 80 80 / 80%);

                svg {
                    color: #c00;
                }
            }
        }

        // Hover auf Karte zeigt Delete-Button
        &:hover .delete {
            opacity: 1;
        }
    }

    // Spezifisches Aspect-Ratio für Tag-Links (oft quadratisch)
    &.tag-page-links a {
        aspect-ratio: 1 / 1;
    }

    // 2. Image Logic
    img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 3px;
        transition: opacity 0.5s;
    }

    // Lazy Loading Logic
    img:not(.delicon) {
        opacity: 0;
    }

    // Wenn geladen oder Noscript -> Sichtbar
    a noscript img,
    a.loaded img {
        opacity: 1;
    }

    // 3. Overlay Visibility Logic
    // Standardmäßig versteckt (außer auf Mobile)
    a span {
        display: none;

        @include media-retina-mobile {
            display: flex;
        }
    }

    // Hover zeigt Overlay
    a:hover span {
        display: flex;
    }

    // 4. Theme Overrides
    /* stylelint-disable no-descending-specificity */
    body.theme-night & {
        a {
            color: var(--text-color);
            background-color: var(--content-area-bg); // Platzhalter dunkel
        }

        a span {
            background-color: rgb(0 0 0 / 80%);
        }

        .delete {
            // Dark Mode Anpassung für Delete Button falls nötig
        }
    }
    /* stylelint-enable no-descending-specificity */
}
